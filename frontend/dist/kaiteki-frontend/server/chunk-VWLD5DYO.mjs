import './polyfills.server.mjs';
import{a as wt,b as ce,c as de}from"./chunk-VJ3Y7BKH.mjs";import{a as me}from"./chunk-7XOCG3NU.mjs";import{b as ft}from"./chunk-AM4SDK4B.mjs";import{a as k}from"./chunk-HOL4TTOB.mjs";import{Aa as ie,Ba as oe,E as Z,G as Xt,I,K as O,L as j,La as ne,M as V,Ma as re,N as z,Na as ae,O as P,Oa as se,Q as L,T as N,U as q,aa as ut,b as F,ba as _t,ca as gt,cb as pe,da as ht,db as kt,ea as Ct,eb as le,f as mt,fa as vt,h as Kt,ha as A,i as w,ia as Zt,ka as $,la as R,n as Nt,na as te,pa as xt,qa as Pt,ra as bt,sa as yt,t as ct,ta as St,ua as Mt,wa as ee,x as dt}from"./chunk-YAF7A7YL.mjs";import{b as Yt,n as Jt}from"./chunk-IWV7G257.mjs";import{Aa as H,Bb as c,D as $t,F as y,Hb as u,I as Rt,Ib as jt,K as G,Ka as Gt,Kb as Y,Lb as J,Mb as r,N as Bt,Nb as a,O as Ft,Ob as d,Rc as st,Sb as Vt,Vb as h,X as It,Xb as C,Y as v,_ as it,_b as K,aa as Ut,ea as ot,eb as Wt,ec as p,f as E,fa as nt,fc as X,gc as D,hb as s,ib as m,ja as W,jd as Qt,k as U,o as _,oc as zt,pa as f,pc as Lt,qa as rt,rd as pt,s as Dt,sd as lt,wd as Ht,xc as M,yc as T,za as Q,zb as x,zc as at}from"./chunk-JAB3SG4D.mjs";import"./chunk-6VT7JIM2.mjs";import{a as et,b as Et}from"./chunk-FME56UVT.mjs";var Ce=(()=>{let i=class i{constructor(e,t,n){this.dialogRef=e,this.data=t,this.toastService=n,this.form=new z({title:new P("",[O.required]),content:new P("",[O.required]),description:new P("",[O.required]),image:new P(null,[Pt.filesLimit(1)])}),this.quillConfig={history:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link"],["clean"]]}}}onSubmit(){let e=this.form.value,t=e.image?.[0]??void 0;if(!e.title||!e.description||!e.content){this.toastService.error("Missing required fields");return}let n={title:e.title,description:e.description,content:e.content,image:t};this.dialogRef.close(n)}onBackClick(){this.dialogRef.close()}};i.\u0275fac=function(t){return new(t||i)(m(ut),m(_t),m(k))},i.\u0275cmp=f({type:i,selectors:[["app-create-post-dialog"]],decls:22,vars:5,consts:[["mat-dialog-title","",1,"cpost__title"],["mat-dialog-content","",1,"cpost"],[1,"cpost__form",3,"formGroup"],["appearance","outline"],["formControlName","title","matInput",""],["formControlName","description","matInput",""],["formControlName","content","theme","snow","placeholder","Write your amazing post",1,"quill__editor",3,"modules"],[1,"cpost__upload-image"],["formControlName","image","fileslimit","1","accept","image/*",3,"multiple","maxsize"],["align","end"],["mat-stroked-button","",3,"click"],["type","submit","mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,n){t&1&&(r(0,"h4",0),p(1,` Write a new post
`),a(),r(2,"section",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),p(6,"Title"),a(),d(7,"input",4),a(),r(8,"mat-form-field",3)(9,"mat-label"),p(10,"Description"),a(),d(11,"input",5),a(),d(12,"quill-editor",6),r(13,"div",7)(14,"p"),p(15,"Upload your hero image"),a(),d(16,"file-upload",8),a()()(),r(17,"mat-dialog-actions",9)(18,"button",10),h("click",function(){return n.onBackClick()}),p(19," Back "),a(),r(20,"button",11),h("click",function(){return n.onSubmit()}),p(21," Post "),a()()),t&2&&(s(3),c("formGroup",n.form),s(9),c("modules",n.quillConfig),s(4),c("multiple",!1)("maxsize",1048576),s(4),c("disabled",n.form.invalid))},dependencies:[F,R,$,A,ht,vt,Ct,L,I,j,V,N,q,xt,bt,yt,St,Mt,wt],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ql-toolbar.ql-snow{border-radius:6px 6px 0 0;background:#fff;padding:16px;border:1px solid #8e8e94}[_nghost-%COMP%]     .ql-editor{padding:16px;min-height:400px}[_nghost-%COMP%]     .ql-editor p{color:#242424}[_nghost-%COMP%]     .ql-editor.ql-blank:before{font-style:normal}[_nghost-%COMP%]     .ql-container.ql-snow{background:#fff;border-radius:0 0 6px 6px;border:1px solid #8e8e94}[_nghost-%COMP%]     file-upload{background:transparent;outline:1px dashed #cacccb;outline-offset:-5px;border-radius:8px}.cpost__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.cpost__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:22px}.cpost__form-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.cpost__upload-image[_ngcontent-%COMP%]{border-radius:8px;background:#fff;padding:16px;border:1px solid #8e8e94}.cpost__upload-image[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;margin-bottom:12px!important;color:#242424}.quill__editor[_ngcontent-%COMP%]{width:100%;margin-bottom:1.6rem}"],changeDetection:0});let o=i;return o})();var ve=(()=>{let i=class i{constructor(e,t,n){this.dialogRef=e,this.data=t,this.toastService=n,this.form=new z({title:new P("",[O.required]),content:new P("",[O.required]),description:new P("",[O.required]),image:new P(null,[Pt.filesLimit(1)])}),this.quillConfig={history:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link"],["clean"]]}}}ngOnInit(){this.fillExistingPost(this.data.post)}fillExistingPost(e){this.form.patchValue({title:e.title,description:e.description,content:e.content,image:[]})}get isFormInvalid(){return this.form.invalid}onSubmit(){let e=this.form.value,t=e.image?.[0]??void 0;if(!e.title||!e.description||!e.content){this.toastService.error("Missing required fields");return}let n={title:e.title,description:e.description,content:e.content,image:t};this.dialogRef.close(n)}onBackClick(){this.dialogRef.close()}};i.\u0275fac=function(t){return new(t||i)(m(ut),m(_t),m(k))},i.\u0275cmp=f({type:i,selectors:[["app-update-post-dialog"]],decls:22,vars:5,consts:[["mat-dialog-title","",1,"cpost__title"],["mat-dialog-content","",1,"cpost"],[1,"cpost__form",3,"formGroup"],["appearance","outline"],["formControlName","title","matInput",""],["formControlName","description","matInput",""],["formControlName","content","theme","snow","placeholder","Write your amazing post",1,"quill__editor",3,"modules"],[1,"cpost__upload-image"],["formControlName","image","fileslimit","1","accept","image/*",3,"multiple","maxsize"],["align","end"],["mat-stroked-button","",3,"click"],["type","submit","mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,n){t&1&&(r(0,"h4",0),p(1,` Update post
`),a(),r(2,"section",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),p(6,"Title"),a(),d(7,"input",4),a(),r(8,"mat-form-field",3)(9,"mat-label"),p(10,"Description"),a(),d(11,"input",5),a(),d(12,"quill-editor",6),r(13,"div",7)(14,"p"),p(15,"Upload your hero image"),a(),d(16,"file-upload",8),a()()(),r(17,"mat-dialog-actions",9)(18,"button",10),h("click",function(){return n.onBackClick()}),p(19," Back "),a(),r(20,"button",11),h("click",function(){return n.onSubmit()}),p(21," Post "),a()()),t&2&&(s(3),c("formGroup",n.form),s(9),c("modules",n.quillConfig),s(4),c("multiple",!1)("maxsize",1048576),s(4),c("disabled",n.isFormInvalid))},dependencies:[F,R,$,A,ht,vt,Ct,L,I,j,V,N,q,xt,bt,yt,St,Mt,wt],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ql-toolbar.ql-snow{border-radius:8px 8px 0 0;background:#fff;padding:16px;border:1px solid #8e8e94}[_nghost-%COMP%]     .ql-editor{padding:16px;min-height:400px}[_nghost-%COMP%]     .ql-editor p{color:#242424}[_nghost-%COMP%]     .ql-editor.ql-blank:before{font-style:normal}[_nghost-%COMP%]     .ql-container.ql-snow{background:#fff;border-radius:0 0 6px 6px;border:1px solid #8e8e94}[_nghost-%COMP%]     file-upload{background:transparent;outline:1px dashed #cacccb;outline-offset:-6px;border-radius:8px}.cpost__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.cpost__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:22px}.cpost__form-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.cpost__upload-image[_ngcontent-%COMP%]{border-radius:8px;background:#fff;padding:16px;border:1px solid #8e8e94}.cpost__upload-image[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;margin-bottom:12px!important;color:#242424}.quill__editor[_ngcontent-%COMP%]{width:100%;margin-bottom:1.6rem}"],changeDetection:0});let o=i;return o})();var xe=(()=>{let i=class i{constructor(e,t,n){this.router=e,this.route=t,this.cd=n,this.filter=new Gt,this.destroy$=new E,this.form=new z({searchValue:new P("")})}ngOnInit(){this.patchInitialFormValues(),this.trackFormValueChanges()}ngOnDestroy(){this.destroy$.complete()}patchInitialFormValues(){let e=this.getQueryParameters();this.form.patchValue({searchValue:e.searchValue}),this.filter.emit(e),this.cd.detectChanges()}trackFormValueChanges(){this.form.valueChanges.pipe(Rt(800),Bt(),it(this.destroy$)).subscribe(e=>{let t={searchValue:e.searchValue??void 0};this.saveQueryParameters(t),this.filter.emit(t)})}saveQueryParameters(e){this.router.navigate([],{queryParams:e,queryParamsHandling:"merge"})}getQueryParameters(){let e={searchValue:""},t=this.route.snapshot.queryParams;return Xt(t,e)}};i.\u0275fac=function(t){return new(t||i)(m(Kt),m(mt),m(st))},i.\u0275cmp=f({type:i,selectors:[["app-posts-filter"]],outputs:{filter:"filter"},decls:13,vars:1,consts:[[1,"filter"],[1,"filter__fields",3,"formGroup"],["appearance","outline"],["matPrefix",""],["matInput","","type","text","formControlName","searchValue"]],template:function(t,n){t&1&&(r(0,"section",0)(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"mat-panel-title"),p(5,"Filters"),a()(),r(6,"form",1)(7,"mat-form-field",2)(8,"mat-label"),p(9,"Search"),a(),r(10,"mat-icon",3),p(11,"search"),a(),d(12,"input",4),a()()()()()),t&2&&(s(6),c("formGroup",n.form))},dependencies:[ct,se,ne,re,ae,R,$,A,Zt,L,I,j,V,N,q],styles:["[_nghost-%COMP%]     mat-form-field{width:100%}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.filter[_ngcontent-%COMP%]{margin-top:22px}.filter__fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1rem;align-items:start}"],changeDetection:0});let o=i;return o})();var Pe=(()=>{let i=class i{constructor(e){this.httpClient=e,this.baseUrl="/api/v1/posts"}getPosts(e,t,n){let g=Et(et(et({},t),n),{teamId:e});return this.httpClient.get(`${this.baseUrl}`,{params:Z(g)})}getLikedPosts(e,t){let n=Et(et({},t),{teamId:e});return this.httpClient.get(`${this.baseUrl}/liked`,{params:Z(n)})}getPost(e,t){return this.httpClient.get(`${this.baseUrl}/${t}`,{params:Z({teamId:e})})}toggleLikePost(e,t){return this.httpClient.post(`${this.baseUrl}/${t}/liked`,{},{params:Z({teamId:e})})}createPost(e,t){let n=new FormData;return t.image&&n.append("image",t.image),n.append("title",t.title),n.append("description",t.description),n.append("content",t.content),this.httpClient.post(`${this.baseUrl}?teamId=${e}`,n)}deletePost(e){return this.httpClient.delete(`${this.baseUrl}/${e}`)}updatePost(e,t){let n=new FormData;return t.image&&n.append("image",t.image),n.append("title",t.title),n.append("description",t.description),n.append("content",t.content),this.httpClient.put(`${this.baseUrl}/${e}`,n)}};i.\u0275fac=function(t){return new(t||i)(W(Yt))},i.\u0275prov=ot({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var B=(()=>{let i=class i{constructor(e,t){this.postsApiService=e,this.teamsService=t,this.refreshPostsSubject=new E,this.refreshPosts$=this.refreshPostsSubject.asObservable()}getPosts(e,t){return this.teamsService.currentTeam$.pipe(v(n=>n?this.postsApiService.getPosts(n.id,e,t):_(()=>Error("No current team"))))}getLikedPosts(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.getLikedPosts(t.id,e):_(()=>Error("No current team"))))}createPost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.createPost(t.id,e):_(()=>Error("No current team"))))}getPost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.getPost(t.id,e):_(()=>Error("No current team"))))}toggleLikePost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.toggleLikePost(t.id,e):_(()=>Error("No current team"))))}deletePost(e){return this.postsApiService.deletePost(e)}updatePost(e,t){return this.postsApiService.updatePost(e,t)}triggerRefreshPosts(){this.refreshPostsSubject.next()}};i.\u0275fac=function(t){return new(t||i)(W(Pe),W(ft))},i.\u0275prov=ot({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var be=(()=>{let i=class i{constructor(e,t,n){this.dialog=e,this.postsService=t,this.toastService=n,this.destroy$=new E}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onWriteClick(e){e.preventDefault(),this.dialog.open(Ce,{minWidth:"70%",minHeight:"80%"}).afterClosed().pipe(v(n=>n?this.postsService.createPost(n):U),y(n=>(this.toastService.error("Failed to create a post"),_(()=>n))),it(this.destroy$)).subscribe(()=>{this.toastService.open("Successfully created a post"),this.postsService.triggerRefreshPosts()})}};i.\u0275fac=function(t){return new(t||i)(m(gt),m(B),m(k))},i.\u0275cmp=f({type:i,selectors:[["app-posts-toolbar"]],decls:11,vars:0,consts:[[1,"posts__toolbar"],[1,"posts__toolbar-left"],[1,"posts__toolbar-title"],[1,"posts__toolbar-right"],["variant","outline","icon","favorite_border","routerLink","favourites",1,"posts__toolbar-item","favourites"],["icon","edit",1,"posts__toolbar-item",3,"click"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),p(3,"Recent Posts"),a()(),r(4,"div",3)(5,"app-button",4)(6,"p"),p(7,"Favourites"),a()(),r(8,"app-button",5),h("click",function(S){return n.onWriteClick(S)}),r(9,"p"),p(10,"Write"),a()()()())},dependencies:[kt,w],styles:[".posts__toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem;overflow-x:auto;overflow-y:hidden}.posts__toolbar-title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.posts__toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}@media (max-width: 40em){.posts__toolbar-left[_ngcontent-%COMP%]{display:none}}.posts__toolbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.posts__toolbar-item[_ngcontent-%COMP%]{text-overflow:ellipsis;text-wrap:nowrap}.favourites[_ngcontent-%COMP%]{display:none}@media (max-width: 48em){.favourites[_ngcontent-%COMP%]{display:block}}"],changeDetection:0});let o=i;return o})();var Ue=["post",""],ye=o=>[o],Me=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-post-item","post",""]],inputs:{post:"post"},attrs:Ue,decls:12,vars:16,consts:[[1,"post"],[1,"post__header"],["size","26","bgColor","#64748B",3,"src","name"],[1,"post__header-author"],[1,"post__header-date"],[1,"post__title",3,"routerLink"],[1,"post__description",3,"routerLink"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1),d(2,"ngx-avatars",2),r(3,"p",3),p(4),a(),r(5,"p",4),p(6),M(7,"date"),a()(),r(8,"h4",5),p(9),a(),r(10,"p",6),p(11),a()()),t&2&&(s(2),K("src","api/v1/files/",n.post.authorTeamMember.avatarId,""),c("name",n.post.authorTeamMember.fullName),s(2),X(n.post.authorTeamMember.fullName),s(2),D(" ",at(7,9,n.post.createdDate,"mediumDate")," "),s(2),c("routerLink",Lt(12,ye,n.post.id)),s(),D(" ",n.post.title," "),s(),c("routerLink",Lt(14,ye,n.post.id)),s(),D(" ",n.post.description," "))},dependencies:[w,dt,lt],styles:[".post[_ngcontent-%COMP%]{padding:16px;border-radius:8px;transition:all .3s ease;background:#fff;border:1px solid #e2e8f0}.post__header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#242424;font-size:14px}.post__title[_ngcontent-%COMP%]{cursor:pointer;margin-top:12px;margin-bottom:8px;font-weight:700;font-size:16px;color:#242424}.post__description[_ngcontent-%COMP%]{cursor:pointer;font-size:14px;color:#242424}"],changeDetection:0});let o=i;return o})();var We=(o,i)=>i.id;function Qe(o,i){if(o&1&&d(0,"app-post-item",1),o&2){let l=i.$implicit;c("post",l)}}var Tt=(()=>{let i=class i{constructor(){this.posts=[]}postsTrackBy(e,t){return t.id}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-posts-list-view"]],inputs:{posts:"posts"},decls:3,vars:0,consts:[[1,"posts__list"],[3,"post"]],template:function(t,n){t&1&&(r(0,"div",0),Y(1,Qe,1,1,"app-post-item",1,We),a()),t&2&&(s(),J(n.posts))},dependencies:[Me],styles:[".posts__list[_ngcontent-%COMP%]{height:100%;overflow-y:auto;display:flex;flex-direction:column;gap:12px}"],changeDetection:0});let o=i;return o})();function He(o,i){if(o&1){let l=Vt();r(0,"button",16),h("click",function(){Q(l);let t=C(3);return H(t.onDeleteClick())}),r(1,"mat-icon"),p(2,"delete_outline"),a()(),r(3,"button",17),h("click",function(){Q(l);let t=C(3);return H(t.onEditClick())}),r(4,"mat-icon"),p(5,"edit_note"),a()()}}function Ye(o,i){o&1&&(r(0,"mat-icon",12),p(1,"favorite"),a())}function Je(o,i){o&1&&(r(0,"mat-icon"),p(1,"favorite_border"),a())}function Ke(o,i){if(o&1&&d(0,"img",13),o&2){let l=C(3);K("src","/api/v1/files/",l.post.heroImageId,"",Wt)}}function Xe(o,i){if(o&1){let l=Vt();r(0,"div",1)(1,"h1",2),p(2),a(),r(3,"div",3)(4,"div",4),d(5,"ngx-avatars",5),r(6,"div",6)(7,"p",7),p(8),a(),r(9,"p",8),p(10),M(11,"date"),a()()(),r(12,"div",9),x(13,He,6,0),r(14,"button",10),h("click",function(){Q(l);let t=C(2);return H(t.onShareClick())}),r(15,"mat-icon"),p(16,"ios_share"),a()(),r(17,"button",11),h("click",function(){Q(l);let t=C(2);return H(t.onLikeClick())}),x(18,Ye,2,0,"mat-icon",12)(19,Je,2,0,"mat-icon"),a()()(),x(20,Ke,1,2,"img",13),r(21,"div",14),d(22,"quill-view",15),a()()}if(o&2){let l=C(),e=C();s(2),X(e.post.title),s(3),K("src","api/v1/files/",e.post.authorTeamMember.avatarId,""),c("name",e.post.authorTeamMember.fullName),s(3),X(e.post.authorTeamMember.fullName),s(2),D(" ",at(11,11,e.post.createdDate,"mediumDate")," "),s(3),u(13,l.id===e.post.authorTeamMember.id?13:-1),s(5),u(18,e.post.liked?18:-1),s(),u(19,e.post.liked?-1:19),s(),u(20,e.post.heroImageId?20:-1),s(2),c("content",e.post.content)}}function Ze(o,i){o&1&&(r(0,"div")(1,"p"),p(2,"Post not found"),a()())}function ti(o,i){if(o&1&&(r(0,"section",0),x(1,Xe,23,14,"div",1)(2,Ze,3,0,"div"),a()),o&2){let l=C();s(),u(1,l.post&&!l.loading?1:-1),s(),u(2,!l.post&&!l.loading?2:-1)}}var we=(()=>{let i=class i{constructor(e,t,n,g,S,Fe,Ie,je,Ve){this.route=e,this.location=t,this.postsService=n,this.toastService=g,this.cd=S,this.sanitizer=Fe,this.clipboard=Ie,this.teamsService=je,this.dialog=Ve,this.post=null,this.loading=!0,this.currentTeamMember$=this.teamsService.currentTeamMember$}ngOnInit(){this.loadPostByUrl()}loadPostByUrl(){let e=this.route.snapshot.paramMap.get("postId"),t=Number(e);if(isNaN(t)){this.toastService.error("The post id is invalid");return}this.postsService.getPost(t).pipe(y(n=>(this.toastService.error("Failed to load post"),_(()=>n))),Ft(()=>{this.loading=!1,this.cd.markForCheck()}),G(1)).subscribe(n=>{this.post=n})}onLikeClick(){this.post&&this.postsService.toggleLikePost(this.post.id).pipe(y(e=>(this.toastService.error("Failed to toggle like post"),_(()=>e))),G(1)).subscribe(()=>{this.post&&(this.post.liked=!this.post.liked,this.cd.markForCheck())})}onShareClick(){let e=window.location.href;this.clipboard.copy(e),this.toastService.open("Link saved to clipboard")}onDeleteClick(){this.post&&this.postsService.deletePost(this.post.id).pipe(y(e=>(this.toastService.error("Failed to delete post"),_(()=>e))),G(1)).subscribe(()=>{this.toastService.open("Successfully deleted post"),this.location.back()})}onEditClick(){if(!this.post)return;this.dialog.open(ve,{data:{post:this.post},minWidth:"90%",minHeight:"90%"}).afterClosed().pipe($t(t=>!!t),v(t=>this.post?this.postsService.updatePost(this.post.id,t).pipe(y(n=>(this.toastService.error("Failed to update post"),_(()=>n)))):U),v(()=>this.post?this.postsService.getPost(this.post.id).pipe(y(t=>(this.toastService.error("Failed to load post"),_(()=>t))),Ft(()=>{this.loading=!1,this.cd.markForCheck()})):U),G(1)).subscribe(t=>{t&&(this.post=t,this.toastService.open("Successfully updated post"))})}};i.\u0275fac=function(t){return new(t||i)(m(mt),m(Qt),m(B),m(k),m(st),m(Jt),m(me),m(ft),m(gt))},i.\u0275cmp=f({type:i,selectors:[["app-post"]],decls:2,vars:3,consts:[[1,"page","post__wrapper"],[1,"post__main"],[1,"post__title"],[1,"post__details"],[1,"post__user"],["size","40","bgColor","#64748B",3,"src","name"],[1,"post__user-right"],[1,"post__user-name"],[1,"post__user-published"],[1,"post__toolbar"],["matTooltip","Share",3,"click"],["matTooltip","Like",3,"click"],[1,"liked"],["loading","eager","alt","Hero Image",1,"post__hero-image",3,"src"],[1,"post__content"],["format","html","theme","snow",3,"content"],["matTooltip","Delete",3,"click"],["matTooltip","Edit",3,"click"]],template:function(t,n){if(t&1&&(x(0,ti,3,2,"section",0),M(1,"async")),t&2){let g;u(0,(g=T(1,1,n.currentTeamMember$))?0:-1,g)}},dependencies:[ct,te,dt,ce,pt,lt],styles:["[_nghost-%COMP%]     .ql-editor{width:100%;padding:0;font-size:16px;line-height:32px;margin-top:26px;color:#242424;font-family:Roboto Slab,serif}.post__wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.post__main[_ngcontent-%COMP%]{max-width:740px;background:#fff;border-radius:12px;padding:34px;border:1px solid #e2e8f0}@media (max-width: 48em){.post__main[_ngcontent-%COMP%]{padding:22px}}.post__title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#242424;line-height:46px}@media (max-width: 48em){.post__title[_ngcontent-%COMP%]{font-size:32px;line-height:38px}}@media (max-width: 40em){.post__title[_ngcontent-%COMP%]{font-size:26px;line-height:34px}}.post__details[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:26px}.post__toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.post__toolbar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.post__user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.post__user-name[_ngcontent-%COMP%]{font-weight:500}.post__user-published[_ngcontent-%COMP%]{color:#797979;margin-top:-2px!important;font-size:12px}.post__hero-image[_ngcontent-%COMP%]{margin-top:26px;width:100%;height:auto;object-fit:contain;background:#fff}.post__content[_ngcontent-%COMP%]{font-size:16px;line-height:32px;margin-top:26px;color:#242424;word-break:break-word;font-family:Roboto Slab,serif}.liked[_ngcontent-%COMP%]{color:red!important}"],changeDetection:0});let o=i;return o})();var Oe=(()=>{let i=class i{constructor(){this.posts=Array(10).fill("posts")}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=f({type:i,selectors:[["app-posts-favorite"]],decls:8,vars:1,consts:[[1,"page","posts__wrapper"],[1,"fav-posts__header"],[1,"fav-posts__title"],["variant","outline","routerLink","../"],[1,"fav-posts__content"],[3,"posts"]],template:function(t,n){t&1&&(r(0,"section",0)(1,"div",1)(2,"h1",2),p(3,"Favorite Posts"),a(),r(4,"app-button",3),p(5,"Return Back"),a()(),r(6,"div",4),d(7,"app-posts-list-view",5),a()()),t&2&&(s(7),c("posts",n.posts))},dependencies:[kt,w,Tt],styles:["h1[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.fav-posts__header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:22px}.fav-posts__title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.fav-posts__content[_ngcontent-%COMP%]{margin-top:22px}"],changeDetection:0});let o=i;return o})();var Te=()=>({height:"120px","border-radius":"8px"});function ei(o,i){if(o&1&&d(0,"app-posts-list-view",10),o&2){let l=C(2);c("posts",l.data)}}function ii(o,i){o&1&&(r(0,"div",11),p(1,"Not posts found"),a())}function oi(o,i){if(o&1&&x(0,ei,1,1,"app-posts-list-view",10)(1,ii,2,0),o&2){let l=C();u(0,l.data.length>0?0:1)}}function ni(o,i){o&1&&(r(0,"div",12),d(1,"ngx-skeleton-loader",13),a()),o&2&&(s(),c("theme",zt(1,Te)))}function ri(o,i){if(o&1&&(r(0,"div",8),Y(1,ni,2,2,"div",12,jt),a()),o&2){let l=C(2);s(),J(l.skeletonArray)}}function ai(o,i){o&1&&(r(0,"div",9)(1,"h1",14),p(2,"404"),a(),r(3,"div",15)(4,"h2",16),p(5," Oops.. "),d(6,"br"),p(7," We couldn't find a posts you are looking for. "),a(),r(8,"button",17)(9,"a",18),p(10,"Return Back"),a()()()())}function si(o,i){if(o&1&&x(0,oi,2,1)(1,ri,3,0,"div",8)(2,ai,11,0,"div",9),o&2){let l=i;u(0,l.data?0:-1),s(),u(1,l.loading?1:-1),s(),u(2,l.error?2:-1)}}function pi(o,i){if(o&1&&d(0,"app-posts-list-view",10),o&2){let l=C(2);c("posts",l.data)}}function li(o,i){o&1&&(r(0,"div",11),p(1,"Not posts found"),a())}function mi(o,i){if(o&1&&(r(0,"div",3),x(1,pi,1,1,"app-posts-list-view",10)(2,li,2,0),a()),o&2){let l=C();s(),u(1,l.data.length>0?1:2)}}function ci(o,i){o&1&&(r(0,"div",20),d(1,"ngx-skeleton-loader",13),a()),o&2&&(s(),c("theme",zt(1,Te)))}function di(o,i){if(o&1&&(r(0,"div",19),Y(1,ci,2,2,"div",20,jt),a()),o&2){let l=C(2);s(),J(l.skeletonArray)}}function fi(o,i){if(o&1&&x(0,mi,3,1,"div",3)(1,di,3,0,"div",19),o&2){let l=i;u(0,l.data?0:-1),s(),u(1,l.loading?1:-1)}}var Ee=(()=>{let i=class i{constructor(e,t){this.postsService=e,this.toastService=t,this.skeletonArray=new Array(10).fill(0),this.filter={},this.pagination=ie,this.posts$=this.postsService.refreshPosts$.pipe(It([]),v(()=>this.loadPosts())),this.likedPosts$=this.postsService.refreshPosts$.pipe(It([]),v(()=>this.loadLikedPosts()))}ngOnInit(){this.postsService.triggerRefreshPosts()}loadPosts(){let e={size:this.pagination.size,page:this.pagination.page};return this.postsService.getPosts(this.filter,e).pipe(Ut(t=>{this.pagination.page=t.number,this.pagination.size=t.size,this.pagination.totalElements=t.totalElements,this.pagination.totalPages=t.totalPages}),Dt(t=>t.content),y(t=>(this.toastService.open("Failed to get posts"),_(()=>t))))}loadLikedPosts(){let e={size:25,page:0};return this.postsService.getLikedPosts(e).pipe(Dt(t=>t.content),y(t=>(this.toastService.open("Failed to get favourite posts"),_(()=>t))))}onPage(e){this.pagination.size=e.size,this.pagination.page=e.page,this.postsService.triggerRefreshPosts()}onFilter(e){this.filter=e,this.postsService.triggerRefreshPosts()}};i.\u0275fac=function(t){return new(t||i)(m(B),m(k))},i.\u0275cmp=f({type:i,selectors:[["app-posts"]],decls:16,vars:11,consts:[[1,"page","posts__wrapper"],[1,"posts__main"],[3,"filter"],[1,"posts__content"],[3,"page","pagination"],[1,"posts__sidebar"],[1,"posts__content-header"],[1,"posts__content-header-title"],[1,"posts__loading-page"],[1,"posts__error","page"],[3,"posts"],[1,"posts__empty"],[1,"posts__loading-element"],["count","1","appearance","line",3,"theme"],[1,"posts__error-title"],[1,"posts__error-content"],[1,"posts__error-subtitle"],["mat-flat-button","","color","primary","routerLink","/hub/overview"],["routerLink","/hub/overview"],[1,"likedPosts__loading-page"],[1,"likedPosts__loading-column"]],template:function(t,n){if(t&1&&(r(0,"section",0)(1,"div",1),d(2,"app-posts-toolbar"),r(3,"app-posts-filter",2),h("filter",function(S){return n.onFilter(S)}),a(),r(4,"div",3),x(5,si,3,3),M(6,"withLoading"),M(7,"async"),a(),r(8,"app-paginator",4),h("page",function(S){return n.onPage(S)}),a()(),r(9,"div",5)(10,"div",6)(11,"h1",7),p(12,"Favorites"),a()(),x(13,fi,2,2),M(14,"withLoading"),M(15,"async"),a()()),t&2){let g,S;s(5),u(5,(g=T(7,5,T(6,3,n.posts$)))?5:-1,g),s(3),c("pagination",n.pagination),s(5),u(13,(S=T(15,9,T(14,7,n.likedPosts$)))?13:-1,S)}},dependencies:[F,w,oe,ee,Tt,be,xe,pt,pe],styles:[".posts[_ngcontent-%COMP%]   app-paginator[_ngcontent-%COMP%]{margin-bottom:20px}.posts__wrapper[_ngcontent-%COMP%]{height:100%;display:flex}@media (max-width: 48em){.posts__wrapper[_ngcontent-%COMP%]{display:inline-block}}.posts__empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;font-size:14px;font-weight:400;color:#bdbdbd;text-transform:capitalize}.posts__main[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;flex:1;padding-right:22px}@media (max-width: 48em){.posts__main[_ngcontent-%COMP%]{border-right:none;padding-right:unset}}.posts__content[_ngcontent-%COMP%]{margin-top:22px;flex:1}.posts__content-header-title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.posts__sidebar[_ngcontent-%COMP%]{height:100%;min-width:300px;max-width:500px;display:none;padding-left:22px;border-left:1px solid #e2e1e1}@media (min-width: 48em){.posts__sidebar[_ngcontent-%COMP%]{display:block}}.posts__loading-page[_ngcontent-%COMP%]{display:grid;grid-template-rows:none;overflow-x:auto}.posts__error[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:100%}.posts__error-content[_ngcontent-%COMP%]{z-index:10;display:flex;flex-direction:column;align-items:center}.posts__error-title[_ngcontent-%COMP%]{color:#d8d7d7;font-size:280px;font-weight:600;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:5;opacity:.25}@media screen and (max-width: 48em){.posts__error-title[_ngcontent-%COMP%]{font-size:180px}}.posts__error-subtitle[_ngcontent-%COMP%]{color:#000;font-size:26px;margin-bottom:26px;text-align:center;line-height:1.4}@media screen and (max-width: 48em){.posts__error-subtitle[_ngcontent-%COMP%]{font-size:20px}}.likedPosts__loading-element[_ngcontent-%COMP%]{z-index:10;display:flex;flex-direction:column}"],changeDetection:0});let o=i;return o})();var ui=[{path:"",component:Ee},{path:":postId",component:we},{path:"favourites",component:Oe}],De=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=rt({type:i}),i.\u0275inj=nt({imports:[Nt.forChild(ui),Nt]});let o=i;return o})();var So=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=rt({type:i}),i.\u0275inj=nt({imports:[Ht,le,De,de.forRoot()]});let o=i;return o})();export{So as PostsModule};
