import{a as me}from"./chunk-TFP54M3R.js";import{a as fe}from"./chunk-3BUG7PFE.js";import{a as kt,c as de}from"./chunk-A7FRXXMC.js";import{c as dt}from"./chunk-YT2TPVYA.js";import{a as k}from"./chunk-AT67HQB2.js";import{Aa as xt,Ba as Pt,C as I,Ca as bt,Da as yt,E as mt,Ea as St,Ga as ie,Ka as oe,La as ne,O as J,Q as Kt,S as j,U as O,V,Va as re,W as L,Wa as ae,X as z,Xa as se,Y as P,Ya as pe,_ as N,b as Xt,ba as q,ca as A,j as Zt,ka as ft,la as ut,ma as _t,n as ct,na as gt,oa as ht,p as Jt,pa as Ct,pb as le,q as w,qb as Mt,ra as $,rb as ce,sa as te,ua as R,v as Lt,va as B,xa as ee,za as vt}from"./chunk-TX7ZHAEW.js";import"./chunk-4N6BO7AP.js";import{Aa as Q,D as qt,F as y,Fb as _,Gb as It,I as At,Ib as Y,Jb as X,K as E,Ka as Bt,Kb as r,Lb as a,Mb as m,N as $t,O as Tt,Oc as st,Qb as rt,Tb as h,Vb as C,X as Ft,Y as v,Yb as Wt,_ as et,aa as Rt,ab as Ut,bb as Gt,cb as Ht,cc as s,dc as Z,dd as Qt,ea as it,ec as F,f as T,fa as ot,fb as p,gb as c,ja as H,k as G,ld as pt,mc as jt,md as lt,nc as Vt,o as g,pa as u,qa as nt,qd as Yt,s as Dt,vc as M,wc as D,xb as x,xc as at,za as W,zb as d}from"./chunk-SMBTFBOT.js";import"./chunk-REV7FFDQ.js";import{a as tt,b as Et}from"./chunk-MON7YFGF.js";var Ce=(()=>{let i=class i{constructor(e,t,n){this.dialogRef=e,this.data=t,this.toastService=n,this.form=new z({title:new P("",[O.required]),content:new P("",[O.required]),description:new P("",[O.required]),image:new P(null,[xt.filesLimit(1)])}),this.quillConfig={history:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link"],["clean"]]}}}onSubmit(){let e=this.form.value,t=e.image?.[0]??void 0;if(!e.title||!e.description||!e.content){this.toastService.error("Missing required fields");return}let n={title:e.title,description:e.description,content:e.content,image:t};this.dialogRef.close(n)}onBackClick(){this.dialogRef.close()}};i.\u0275fac=function(t){return new(t||i)(c(ft),c(ut),c(k))},i.\u0275cmp=u({type:i,selectors:[["app-create-post-dialog"]],decls:22,vars:5,consts:[["mat-dialog-title","",1,"cpost__title"],["mat-dialog-content","",1,"cpost"],[1,"cpost__form",3,"formGroup"],["appearance","outline"],["formControlName","title","matInput",""],["formControlName","description","matInput",""],["formControlName","content","theme","snow","placeholder","Write your amazing post",1,"quill__editor",3,"modules"],[1,"cpost__upload-image"],["formControlName","image","fileslimit","1","accept","image/*",3,"multiple","maxsize"],["align","end"],["mat-stroked-button","",3,"click"],["type","submit","mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,n){t&1&&(r(0,"h4",0),s(1,` Write a new post
`),a(),r(2,"section",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),s(6,"Title"),a(),m(7,"input",4),a(),r(8,"mat-form-field",3)(9,"mat-label"),s(10,"Description"),a(),m(11,"input",5),a(),m(12,"quill-editor",6),r(13,"div",7)(14,"p"),s(15,"Upload your hero image"),a(),m(16,"file-upload",8),a()()(),r(17,"mat-dialog-actions",9)(18,"button",10),h("click",function(){return n.onBackClick()}),s(19," Back "),a(),r(20,"button",11),h("click",function(){return n.onSubmit()}),s(21," Post "),a()()),t&2&&(p(3),d("formGroup",n.form),p(9),d("modules",n.quillConfig),p(4),d("multiple",!1)("maxsize",1048576),p(4),d("disabled",n.form.invalid))},dependencies:[I,B,R,$,gt,Ct,ht,N,j,V,L,q,A,vt,Pt,bt,yt,St,kt],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ql-toolbar.ql-snow{border-radius:6px 6px 0 0;background:#fff;padding:16px;border:1px solid #8e8e94}[_nghost-%COMP%]     .ql-editor{padding:16px;min-height:400px}[_nghost-%COMP%]     .ql-editor p{color:#242424}[_nghost-%COMP%]     .ql-editor.ql-blank:before{font-style:normal}[_nghost-%COMP%]     .ql-container.ql-snow{background:#fff;border-radius:0 0 6px 6px;border:1px solid #8e8e94}[_nghost-%COMP%]     file-upload{background:transparent;outline:1px dashed #cacccb;outline-offset:-5px;border-radius:6px}.cpost__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.cpost__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:22px}.cpost__form-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.cpost__upload-image[_ngcontent-%COMP%]{border-radius:6px;background:#fff;padding:16px;border:1px solid #8e8e94}.cpost__upload-image[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;margin-bottom:12px!important;color:#242424}.quill__editor[_ngcontent-%COMP%]{width:100%;margin-bottom:1.6rem}"],changeDetection:0});let o=i;return o})();var ve=(()=>{let i=class i{constructor(e,t,n,f){this.dialogRef=e,this.data=t,this.filesService=n,this.toastService=f,this.form=new z({title:new P("",[O.required]),content:new P("",[O.required]),description:new P("",[O.required]),image:new P(null,[xt.filesLimit(1)])}),this.quillConfig={history:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link"],["clean"]]}}}ngOnInit(){this.fillExistingPost(this.data.post)}fillExistingPost(e){if(!e.heroImageId)return this.form.patchValue({title:e.title,description:e.description,content:e.content,image:void 0});this.filesService.getFileBlob(e.heroImageId).pipe(E(1)).subscribe(t=>{let n=new File([t],"Hero Image");return this.form.patchValue({title:e.title,description:e.description,content:e.content,image:[n]})})}onSubmit(){let e=this.form.value,t=e.image?.[0]??void 0;if(!e.title||!e.description||!e.content){this.toastService.error("Missing required fields");return}let n={title:e.title,description:e.description,content:e.content,image:t};this.dialogRef.close(n)}onBackClick(){this.dialogRef.close()}};i.\u0275fac=function(t){return new(t||i)(c(ft),c(ut),c(fe),c(k))},i.\u0275cmp=u({type:i,selectors:[["app-update-post-dialog"]],decls:22,vars:5,consts:[["mat-dialog-title","",1,"cpost__title"],["mat-dialog-content","",1,"cpost"],[1,"cpost__form",3,"formGroup"],["appearance","outline"],["formControlName","title","matInput",""],["formControlName","description","matInput",""],["formControlName","content","theme","snow","placeholder","Write your amazing post",1,"quill__editor",3,"modules"],[1,"cpost__upload-image"],["formControlName","image","fileslimit","1","accept","image/*",3,"multiple","maxsize"],["align","end"],["mat-stroked-button","",3,"click"],["type","submit","mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,n){t&1&&(r(0,"h4",0),s(1,` Update post
`),a(),r(2,"section",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),s(6,"Title"),a(),m(7,"input",4),a(),r(8,"mat-form-field",3)(9,"mat-label"),s(10,"Description"),a(),m(11,"input",5),a(),m(12,"quill-editor",6),r(13,"div",7)(14,"p"),s(15,"Upload your hero image"),a(),m(16,"file-upload",8),a()()(),r(17,"mat-dialog-actions",9)(18,"button",10),h("click",function(){return n.onBackClick()}),s(19," Back "),a(),r(20,"button",11),h("click",function(){return n.onSubmit()}),s(21," Post "),a()()),t&2&&(p(3),d("formGroup",n.form),p(9),d("modules",n.quillConfig),p(4),d("multiple",!1)("maxsize",1048576),p(4),d("disabled",n.form.invalid))},dependencies:[I,B,R,$,gt,Ct,ht,N,j,V,L,q,A,vt,Pt,bt,yt,St,kt],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ql-toolbar.ql-snow{border-radius:6px 6px 0 0;background:#fff;padding:16px;border:1px solid #8e8e94}[_nghost-%COMP%]     .ql-editor{padding:16px;min-height:400px}[_nghost-%COMP%]     .ql-editor p{color:#242424}[_nghost-%COMP%]     .ql-editor.ql-blank:before{font-style:normal}[_nghost-%COMP%]     .ql-container.ql-snow{background:#fff;border-radius:0 0 6px 6px;border:1px solid #8e8e94}[_nghost-%COMP%]     file-upload{background:transparent;outline:1px dashed #cacccb;outline-offset:-5px;border-radius:6px}.cpost__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.cpost__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:22px}.cpost__form-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.cpost__upload-image[_ngcontent-%COMP%]{border-radius:6px;background:#fff;padding:16px;border:1px solid #8e8e94}.cpost__upload-image[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;margin-bottom:12px!important;color:#242424}.quill__editor[_ngcontent-%COMP%]{width:100%;margin-bottom:1.6rem}"],changeDetection:0});let o=i;return o})();var xe=(()=>{let i=class i{constructor(e,t,n){this.router=e,this.route=t,this.cd=n,this.filter=new Bt,this.destroy$=new T,this.form=new z({searchValue:new P("")})}ngOnInit(){this.patchInitialFormValues(),this.trackFormValueChanges()}ngOnDestroy(){this.destroy$.complete()}patchInitialFormValues(){let e=this.getQueryParameters();this.form.patchValue({searchValue:e.searchValue}),this.filter.emit(e),this.cd.detectChanges()}trackFormValueChanges(){this.form.valueChanges.pipe(At(800),$t(),et(this.destroy$)).subscribe(e=>{let t={searchValue:e.searchValue??void 0};this.saveQueryParameters(t),this.filter.emit(t)})}saveQueryParameters(e){this.router.navigate([],{queryParams:e,queryParamsHandling:"merge"})}getQueryParameters(){let e={searchValue:""},t=this.route.snapshot.queryParams;return Kt(t,e)}};i.\u0275fac=function(t){return new(t||i)(c(Jt),c(ct),c(st))},i.\u0275cmp=u({type:i,selectors:[["app-posts-filter"]],outputs:{filter:"filter"},decls:13,vars:1,consts:[[1,"filter"],[1,"filter__fields",3,"formGroup"],["appearance","outline"],["matPrefix",""],["matInput","","type","text","formControlName","searchValue"]],template:function(t,n){t&1&&(r(0,"section",0)(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"mat-panel-title"),s(5,"Filters"),a()(),r(6,"form",1)(7,"mat-form-field",2)(8,"mat-label"),s(9,"Search"),a(),r(10,"mat-icon",3),s(11,"search"),a(),m(12,"input",4),a()()()()()),t&2&&(p(6),d("formGroup",n.form))},dependencies:[mt,pe,re,ae,se,B,R,$,te,N,j,V,L,q,A],styles:["[_nghost-%COMP%]     mat-form-field{width:100%}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.filter[_ngcontent-%COMP%]{margin-top:22px}.filter__fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1rem;align-items:start}"],changeDetection:0});let o=i;return o})();var Pe=(()=>{let i=class i{constructor(e){this.httpClient=e,this.baseUrl="/api/v1/posts"}getPosts(e,t,n){let f=Et(tt(tt({},t),n),{teamId:e});return this.httpClient.get(`${this.baseUrl}`,{params:J(f)})}getLikedPosts(e,t){let n=Et(tt({},t),{teamId:e});return this.httpClient.get(`${this.baseUrl}/liked`,{params:J(n)})}getPost(e,t){return this.httpClient.get(`${this.baseUrl}/${t}`,{params:J({teamId:e})})}toggleLikePost(e,t){return this.httpClient.post(`${this.baseUrl}/${t}/liked`,{},{params:J({teamId:e})})}createPost(e,t){let n=new FormData;return t.image&&n.append("image",t.image),n.append("title",t.title),n.append("description",t.description),n.append("content",t.content),this.httpClient.post(`${this.baseUrl}?teamId=${e}`,n)}deletePost(e){return this.httpClient.delete(`${this.baseUrl}/${e}`)}updatePost(e,t){let n=new FormData;return t.image&&n.append("image",t.image),n.append("title",t.title),n.append("description",t.description),n.append("content",t.content),this.httpClient.put(`${this.baseUrl}/${e}`,n)}};i.\u0275fac=function(t){return new(t||i)(H(Xt))},i.\u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var U=(()=>{let i=class i{constructor(e,t){this.postsApiService=e,this.teamsService=t,this.refreshPostsSubject=new T,this.refreshPosts$=this.refreshPostsSubject.asObservable()}getPosts(e,t){return this.teamsService.currentTeam$.pipe(v(n=>n?this.postsApiService.getPosts(n.id,e,t):g(()=>Error("No current team"))))}getLikedPosts(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.getLikedPosts(t.id,e):g(()=>Error("No current team"))))}createPost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.createPost(t.id,e):g(()=>Error("No current team"))))}getPost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.getPost(t.id,e):g(()=>Error("No current team"))))}toggleLikePost(e){return this.teamsService.currentTeam$.pipe(v(t=>t?this.postsApiService.toggleLikePost(t.id,e):g(()=>Error("No current team"))))}deletePost(e){return this.postsApiService.deletePost(e)}updatePost(e,t){return this.postsApiService.updatePost(e,t)}triggerRefreshPosts(){this.refreshPostsSubject.next()}};i.\u0275fac=function(t){return new(t||i)(H(Pe),H(dt))},i.\u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var be=(()=>{let i=class i{constructor(e,t,n){this.dialog=e,this.postsService=t,this.toastService=n,this.destroy$=new T}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onWriteClick(e){e.preventDefault(),this.dialog.open(Ce,{minWidth:"70%",minHeight:"80%"}).afterClosed().pipe(v(n=>n?this.postsService.createPost(n):G),y(n=>(this.toastService.error("Failed to create a post"),g(()=>n))),et(this.destroy$)).subscribe(()=>{this.toastService.open("Successfully created a post"),this.postsService.triggerRefreshPosts()})}};i.\u0275fac=function(t){return new(t||i)(c(_t),c(U),c(k))},i.\u0275cmp=u({type:i,selectors:[["app-posts-toolbar"]],decls:11,vars:0,consts:[[1,"posts__toolbar"],[1,"posts__toolbar-left"],[1,"posts__toolbar-title"],[1,"posts__toolbar-right"],["variant","outline","icon","favorite_border","routerLink","favourites",1,"posts__toolbar-item","favourites"],["icon","edit",1,"posts__toolbar-item",3,"click"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Recent Posts"),a()(),r(4,"div",3)(5,"app-button",4)(6,"p"),s(7,"Favourites"),a()(),r(8,"app-button",5),h("click",function(S){return n.onWriteClick(S)}),r(9,"p"),s(10,"Write"),a()()()())},dependencies:[Mt,w],styles:[".posts__toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem;overflow-x:auto;overflow-y:hidden}.posts__toolbar-title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.posts__toolbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}@media (max-width: 40em){.posts__toolbar-left[_ngcontent-%COMP%]{display:none}}.posts__toolbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.posts__toolbar-item[_ngcontent-%COMP%]{text-overflow:ellipsis;text-wrap:nowrap}.favourites[_ngcontent-%COMP%]{display:none}@media (max-width: 48em){.favourites[_ngcontent-%COMP%]{display:block}}"],changeDetection:0});let o=i;return o})();var Ue=["post",""],ye=o=>[o],Me=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=u({type:i,selectors:[["app-post-item","post",""]],inputs:{post:"post"},attrs:Ue,decls:12,vars:13,consts:[[1,"post"],[1,"post__header"],["src","","alt","Alon Abadi",1,"post__header-img"],[1,"post__header-author"],[1,"post__header-date"],[1,"post__title",3,"routerLink"],[1,"post__description",3,"routerLink"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1),m(2,"img",2),r(3,"p",3),s(4),a(),r(5,"p",4),s(6),M(7,"date"),a()(),r(8,"h4",5),s(9),a(),r(10,"p",6),s(11),a()()),t&2&&(p(4),Z(n.post.authorFullName),p(2),F(" ",at(7,6,n.post.createdDate,"mediumDate")," "),p(2),d("routerLink",Vt(9,ye,n.post.id)),p(),F(" ",n.post.title," "),p(),d("routerLink",Vt(11,ye,n.post.id)),p(),F(" ",n.post.description," "))},dependencies:[w,lt],styles:[".post[_ngcontent-%COMP%]{padding:16px;border-radius:8px;transition:all .3s ease;background:#fff;border:1px solid #e9e9e9}.post__header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#242424;font-size:14px}.post__header-img[_ngcontent-%COMP%]{width:20px;height:20px;background:#192597;border-radius:9999px}.post__title[_ngcontent-%COMP%]{cursor:pointer;margin-top:12px;margin-bottom:8px;font-weight:700;font-size:16px;color:#242424}.post__description[_ngcontent-%COMP%]{cursor:pointer;font-size:14px;color:#242424}"],changeDetection:0});let o=i;return o})();var He=(o,i)=>i.id;function We(o,i){if(o&1&&m(0,"app-post-item",1),o&2){let l=i.$implicit;d("post",l)}}var Ot=(()=>{let i=class i{constructor(){this.posts=[]}postsTrackBy(e,t){return t.id}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=u({type:i,selectors:[["app-posts-list-view"]],inputs:{posts:"posts"},decls:3,vars:0,consts:[[1,"posts__list"],[3,"post"]],template:function(t,n){t&1&&(r(0,"div",0),Y(1,We,1,1,"app-post-item",1,He),a()),t&2&&(p(),X(n.posts))},dependencies:[Me],styles:[".posts__list[_ngcontent-%COMP%]{height:100%;overflow-y:auto;display:flex;flex-direction:column;gap:12px}"],changeDetection:0});let o=i;return o})();function Qe(o,i){if(o&1){let l=rt();r(0,"button",18),h("click",function(){W(l);let t=C(3);return Q(t.onDeleteClick())}),r(1,"mat-icon"),s(2,"delete_outline"),a()()}}function Ye(o,i){if(o&1){let l=rt();r(0,"button",19),h("click",function(){W(l);let t=C(3);return Q(t.onEditClick())}),r(1,"mat-icon"),s(2,"edit_note"),a()()}}function Xe(o,i){o&1&&(r(0,"mat-icon",14),s(1,"favorite"),a())}function Ze(o,i){o&1&&(r(0,"mat-icon"),s(1,"favorite_border"),a())}function Je(o,i){if(o&1){let l=rt();r(0,"div",1)(1,"h1",2),s(2),a(),r(3,"div",3)(4,"div",4),m(5,"img",5),r(6,"div",6)(7,"p",7),s(8),a(),r(9,"p",8),s(10),M(11,"date"),a()()(),r(12,"div",9),x(13,Qe,3,0,"button",10)(14,Ye,3,0,"button",11),r(15,"button",12),h("click",function(){W(l);let t=C(2);return Q(t.onShareClick())}),r(16,"mat-icon"),s(17,"ios_share"),a()(),r(18,"button",13),h("click",function(){W(l);let t=C(2);return Q(t.onLikeClick())}),x(19,Xe,2,0,"mat-icon",14)(20,Ze,2,0,"mat-icon"),a()()(),m(21,"img",15),r(22,"div",16),m(23,"p",17),a()()}if(o&2){let l=C(),e=C();p(2),Z(e.post.title),p(6),Z(e.post.authorFullName),p(2),F(" ",at(11,10,e.post.createdDate,"mediumDate")," "),p(3),_(13,l.id===e.post.authorMemberId?13:-1),p(),_(14,l.id===e.post.authorMemberId?14:-1),p(5),_(19,e.post.liked?19:-1),p(),_(20,e.post.liked?-1:20),p(),Wt("src","/api/v1/files/",e.post.heroImageId,"",Ht),p(2),d("innerHTML",e.safeHtmlContent,Gt)}}function Ke(o,i){o&1&&(r(0,"div")(1,"p"),s(2,"Post not found"),a()())}function ti(o,i){if(o&1&&(r(0,"section",0),x(1,Je,24,13,"div",1)(2,Ke,3,0,"div"),a()),o&2){let l=C();p(),_(1,l.post&&!l.loading?1:-1),p(),_(2,!l.post&&!l.loading?2:-1)}}var we=(()=>{let i=class i{constructor(e,t,n,f,S,Fe,Ie,je,Ve){this.route=e,this.location=t,this.postsService=n,this.toastService=f,this.cd=S,this.sanitizer=Fe,this.clipboard=Ie,this.teamsService=je,this.dialog=Ve,this.post=null,this.loading=!0,this.currentTeamMember$=this.teamsService.currentTeamMember$}ngOnInit(){this.loadPostByUrl()}loadPostByUrl(){let e=this.route.snapshot.paramMap.get("postId"),t=Number(e);if(isNaN(t)){this.toastService.error("The post id is invalid");return}this.postsService.getPost(t).pipe(y(n=>(this.toastService.error("Failed to load post"),g(()=>n))),Tt(()=>{this.loading=!1,this.cd.markForCheck()}),E(1)).subscribe(n=>{this.post=n})}onLikeClick(){this.post&&this.postsService.toggleLikePost(this.post.id).pipe(y(e=>(this.toastService.error("Failed to toggle like post"),g(()=>e))),E(1)).subscribe(()=>{this.post&&(this.post.liked=!this.post.liked,this.cd.markForCheck())})}onShareClick(){let e=window.location.href;this.clipboard.copy(e),this.toastService.open("Link saved to clipboard")}onDeleteClick(){this.post&&this.postsService.deletePost(this.post.id).pipe(y(e=>(this.toastService.error("Failed to delete post"),g(()=>e))),E(1)).subscribe(()=>{this.toastService.open("Successfully deleted post"),this.location.back()})}onEditClick(){if(!this.post)return;this.dialog.open(ve,{data:{post:this.post},minWidth:"90%",minHeight:"90%"}).afterClosed().pipe(qt(t=>!!t),v(t=>this.post?this.postsService.updatePost(this.post.id,t).pipe(y(n=>(this.toastService.error("Failed to update post"),g(()=>n)))):G),v(()=>this.post?this.postsService.getPost(this.post.id).pipe(y(t=>(this.toastService.error("Failed to load post"),g(()=>t))),Tt(()=>{this.loading=!1,this.cd.markForCheck()})):G),E(1)).subscribe(t=>{t&&(this.post=t,this.toastService.open("Successfully updated post"))})}get safeHtmlContent(){return this.post?this.sanitizer.sanitize(Ut.HTML,this.post.content):""}};i.\u0275fac=function(t){return new(t||i)(c(ct),c(Qt),c(U),c(k),c(st),c(Zt),c(me),c(dt),c(_t))},i.\u0275cmp=u({type:i,selectors:[["app-post"]],decls:2,vars:3,consts:[[1,"page","post__wrapper"],[1,"post__main"],[1,"post__title"],[1,"post__details"],[1,"post__user"],["src","https://miro.medium.com/v2/resize:fill:44:44/1*FCSZoy-APX517P8IPmI6pw.png","alt","Vaishinov Manoj",1,"post__user-avatar"],[1,"post__user-right"],[1,"post__user-name"],[1,"post__user-published"],[1,"post__toolbar"],["matTooltip","Delete"],["matTooltip","Edit"],["matTooltip","Share",3,"click"],["matTooltip","Like",3,"click"],[1,"liked"],["loading","eager","alt","Hero Image",1,"post__hero-image",3,"src"],[1,"post__content"],[3,"innerHTML"],["matTooltip","Delete",3,"click"],["matTooltip","Edit",3,"click"]],template:function(t,n){if(t&1&&(x(0,ti,3,2,"section",0),M(1,"async")),t&2){let f;_(0,(f=D(1,1,n.currentTeamMember$))?0:-1,f)}},dependencies:[mt,ee,pt,lt],styles:['[_nghost-%COMP%]     mark{background-color:#e8f3e8;color:currentcolor}.post__wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.post__main[_ngcontent-%COMP%]{max-width:740px;background:#fff;border-radius:12px;padding:34px;border:1px solid #ebeaea}@media (max-width: 48em){.post__main[_ngcontent-%COMP%]{padding:22px}}.post__title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#242424;line-height:46px}@media (max-width: 48em){.post__title[_ngcontent-%COMP%]{font-size:32px;line-height:38px}}@media (max-width: 40em){.post__title[_ngcontent-%COMP%]{font-size:26px;line-height:34px}}.post__details[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:26px}.post__toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.post__toolbar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.post__user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.post__user-avatar[_ngcontent-%COMP%]{width:44px;height:44px;background:#aaa;border-radius:9999px}.post__user-name[_ngcontent-%COMP%]{font-weight:500}.post__user-published[_ngcontent-%COMP%]{color:#797979;margin-top:4px}.post__hero-image[_ngcontent-%COMP%]{margin-top:26px;width:100%;height:auto;object-fit:contain;background:#fff}.post__content[_ngcontent-%COMP%]{font-size:18px;line-height:28px;margin-top:26px;color:#242424;font-family:"Source Serif 4",serif}.liked[_ngcontent-%COMP%]{color:red!important}'],changeDetection:0});let o=i;return o})();var Oe=(()=>{let i=class i{constructor(){this.posts=Array(10).fill("posts")}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=u({type:i,selectors:[["app-posts-favorite"]],decls:8,vars:1,consts:[[1,"page","posts__wrapper"],[1,"fav-posts__header"],[1,"fav-posts__title"],["variant","outline","routerLink","../"],[1,"fav-posts__content"],[3,"posts"]],template:function(t,n){t&1&&(r(0,"section",0)(1,"div",1)(2,"h1",2),s(3,"Favorite Posts"),a(),r(4,"app-button",3),s(5,"Return Back"),a()(),r(6,"div",4),m(7,"app-posts-list-view",5),a()()),t&2&&(p(7),d("posts",n.posts))},dependencies:[Mt,w,Ot],styles:["h1[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.fav-posts__header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:22px}.fav-posts__title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.fav-posts__content[_ngcontent-%COMP%]{margin-top:22px}"],changeDetection:0});let o=i;return o})();var Ee=()=>({height:"120px","border-radius":"8px"});function ei(o,i){if(o&1&&m(0,"app-posts-list-view",10),o&2){let l=C(2);d("posts",l.data)}}function ii(o,i){o&1&&(r(0,"div",11),s(1,"Not posts found"),a())}function oi(o,i){if(o&1&&x(0,ei,1,1,"app-posts-list-view",10)(1,ii,2,0),o&2){let l=C();_(0,l.data.length>0?0:1)}}function ni(o,i){o&1&&(r(0,"div",12),m(1,"ngx-skeleton-loader",13),a()),o&2&&(p(),d("theme",jt(1,Ee)))}function ri(o,i){if(o&1&&(r(0,"div",8),Y(1,ni,2,2,"div",12,It),a()),o&2){let l=C(2);p(),X(l.skeletonArray)}}function ai(o,i){o&1&&(r(0,"div",9)(1,"h1",14),s(2,"404"),a(),r(3,"div",15)(4,"h2",16),s(5," Oops.. "),m(6,"br"),s(7," We couldn't find a posts you are looking for. "),a(),r(8,"button",17)(9,"a",18),s(10,"Return Back"),a()()()())}function si(o,i){if(o&1&&x(0,oi,2,1)(1,ri,3,0,"div",8)(2,ai,11,0,"div",9),o&2){let l=i;_(0,l.data?0:-1),p(),_(1,l.loading?1:-1),p(),_(2,l.error?2:-1)}}function pi(o,i){if(o&1&&m(0,"app-posts-list-view",10),o&2){let l=C(2);d("posts",l.data)}}function li(o,i){o&1&&(r(0,"div",11),s(1,"Not posts found"),a())}function ci(o,i){if(o&1&&(r(0,"div",3),x(1,pi,1,1,"app-posts-list-view",10)(2,li,2,0),a()),o&2){let l=C();p(),_(1,l.data.length>0?1:2)}}function mi(o,i){o&1&&(r(0,"div",20),m(1,"ngx-skeleton-loader",13),a()),o&2&&(p(),d("theme",jt(1,Ee)))}function di(o,i){if(o&1&&(r(0,"div",19),Y(1,mi,2,2,"div",20,It),a()),o&2){let l=C(2);p(),X(l.skeletonArray)}}function fi(o,i){if(o&1&&x(0,ci,3,1,"div",3)(1,di,3,0,"div",19),o&2){let l=i;_(0,l.data?0:-1),p(),_(1,l.loading?1:-1)}}var De=(()=>{let i=class i{constructor(e,t){this.postsService=e,this.toastService=t,this.skeletonArray=new Array(10).fill(0),this.filter={},this.pagination=oe,this.posts$=this.postsService.refreshPosts$.pipe(Ft([]),v(()=>this.loadPosts())),this.likedPosts$=this.postsService.refreshPosts$.pipe(Ft([]),v(()=>this.loadLikedPosts()))}ngOnInit(){this.postsService.triggerRefreshPosts()}loadPosts(){let e={size:this.pagination.size,page:this.pagination.page};return this.postsService.getPosts(this.filter,e).pipe(Rt(t=>{this.pagination.page=t.number,this.pagination.size=t.size,this.pagination.totalElements=t.totalElements,this.pagination.totalPages=t.totalPages}),Dt(t=>t.content),y(t=>(this.toastService.open("Failed to get posts"),g(()=>t))))}loadLikedPosts(){let e={size:25,page:0};return this.postsService.getLikedPosts(e).pipe(Dt(t=>t.content),y(t=>(this.toastService.open("Failed to get favourite posts"),g(()=>t))))}onPage(e){this.pagination.size=e.size,this.pagination.page=e.page,this.postsService.triggerRefreshPosts()}onFilter(e){this.filter=e,this.postsService.triggerRefreshPosts()}};i.\u0275fac=function(t){return new(t||i)(c(U),c(k))},i.\u0275cmp=u({type:i,selectors:[["app-posts"]],decls:16,vars:11,consts:[[1,"page","posts__wrapper"],[1,"posts__main"],[3,"filter"],[1,"posts__content"],[3,"page","pagination"],[1,"posts__sidebar"],[1,"posts__content-header"],[1,"posts__content-header-title"],[1,"posts__loading-page"],[1,"posts__error","page"],[3,"posts"],[1,"posts__empty"],[1,"posts__loading-element"],["count","1","appearance","line",3,"theme"],[1,"posts__error-title"],[1,"posts__error-content"],[1,"posts__error-subtitle"],["mat-flat-button","","color","primary","routerLink","/hub/overview"],["routerLink","/hub/overview"],[1,"likedPosts__loading-page"],[1,"likedPosts__loading-column"]],template:function(t,n){if(t&1&&(r(0,"section",0)(1,"div",1),m(2,"app-posts-toolbar"),r(3,"app-posts-filter",2),h("filter",function(S){return n.onFilter(S)}),a(),r(4,"div",3),x(5,si,3,3),M(6,"withLoading"),M(7,"async"),a(),r(8,"app-paginator",4),h("page",function(S){return n.onPage(S)}),a()(),r(9,"div",5)(10,"div",6)(11,"h1",7),s(12,"Favorites"),a()(),x(13,fi,2,2),M(14,"withLoading"),M(15,"async"),a()()),t&2){let f,S;p(5),_(5,(f=D(7,5,D(6,3,n.posts$)))?5:-1,f),p(3),d("pagination",n.pagination),p(5),_(13,(S=D(15,9,D(14,7,n.likedPosts$)))?13:-1,S)}},dependencies:[I,w,ne,ie,Ot,be,xe,pt,le],styles:[".posts[_ngcontent-%COMP%]   app-paginator[_ngcontent-%COMP%]{margin-bottom:20px}.posts__wrapper[_ngcontent-%COMP%]{height:100%;display:flex}@media (max-width: 48em){.posts__wrapper[_ngcontent-%COMP%]{display:inline-block}}.posts__empty[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;font-size:14px;font-weight:400;color:#bdbdbd;text-transform:capitalize}.posts__main[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;flex:1;padding-right:22px}@media (max-width: 48em){.posts__main[_ngcontent-%COMP%]{border-right:none;padding-right:unset}}.posts__content[_ngcontent-%COMP%]{margin-top:22px;flex:1}.posts__content-header-title[_ngcontent-%COMP%]{font-size:22px;font-weight:500}.posts__sidebar[_ngcontent-%COMP%]{height:100%;min-width:300px;max-width:500px;display:none;padding-left:22px;border-left:1px solid #e2e1e1}@media (min-width: 48em){.posts__sidebar[_ngcontent-%COMP%]{display:block}}.posts__loading-page[_ngcontent-%COMP%]{display:grid;grid-template-rows:none;overflow-x:auto}.posts__error[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:100%}.posts__error-content[_ngcontent-%COMP%]{z-index:10;display:flex;flex-direction:column;align-items:center}.posts__error-title[_ngcontent-%COMP%]{color:#d8d7d7;font-size:280px;font-weight:600;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:5;opacity:.25}@media screen and (max-width: 48em){.posts__error-title[_ngcontent-%COMP%]{font-size:180px}}.posts__error-subtitle[_ngcontent-%COMP%]{color:#000;font-size:26px;margin-bottom:26px;text-align:center;line-height:1.4}@media screen and (max-width: 48em){.posts__error-subtitle[_ngcontent-%COMP%]{font-size:20px}}.likedPosts__loading-element[_ngcontent-%COMP%]{z-index:10;display:flex;flex-direction:column}"],changeDetection:0});let o=i;return o})();var ui=[{path:"",component:De},{path:":postId",component:we},{path:"favourites",component:Oe}],Te=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=nt({type:i}),i.\u0275inj=ot({imports:[Lt.forChild(ui),Lt]});let o=i;return o})();var Eo=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=nt({type:i}),i.\u0275inj=ot({imports:[Yt,ce,Te,de.forRoot()]});let o=i;return o})();export{Eo as PostsModule};
