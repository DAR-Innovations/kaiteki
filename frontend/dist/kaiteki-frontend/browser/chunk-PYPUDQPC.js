import{a as w}from"./chunk-ON7GQ3QU.js";import{a as rt}from"./chunk-CC5637K2.js";import{a as v}from"./chunk-AT67HQB2.js";import{E as L,Ia as $,c as ot,n as j,p as at,pb as st,q as F,rb as lt,v as U}from"./chunk-TX7ZHAEW.js";import{F as P,Fb as d,Ib as M,Jb as O,Kb as n,Lb as o,Mb as c,O as q,Oc as tt,Vb as _,aa as G,cb as b,cc as s,dc as C,ea as J,ec as k,f as Y,fa as T,fb as l,fc as X,gb as y,ja as R,jd as et,k as N,ld as A,md as it,nc as I,o as h,pa as g,qa as D,qd as nt,s as H,t as Q,vc as x,wc as E,xb as u,xc as Z,zb as m}from"./chunk-SMBTFBOT.js";var vt=(e,t)=>t.track.id;function St(e,t){if(e&1&&(n(0,"tr")(1,"td"),s(2),o(),n(3,"td",5),c(4,"img",6),n(5,"div",7)(6,"p",8),s(7),o(),n(8,"p",9),s(9),o()()(),n(10,"td",10),s(11),o(),n(12,"td",11),s(13),x(14,"date"),o(),n(15,"td"),s(16),o()()),e&2){let r=t.$implicit,a=t.$index,i=_();l(2),C(a+1),l(2),m("src",r.track.album.images[0].url,b),l(3),C(r.track.name),l(2),k(" ",i.getTrackArtistsNames(r.track.artists)," "),l(2),C(r.track.album.name),l(2),k(" ",Z(14,7,r.track.album.releaseDate,"MMM d, y")," "),l(3),C(i.formatMsToMinutes(r.track.durationMs))}}var ct=(()=>{let t=class t{constructor(){this.songs=[]}getTrackArtistsNames(a){return a.map(i=>i.name).join(", ")}formatMsToMinutes(a){let i=Math.floor(a/1e3),p=Math.floor(i/60),f=i%60,z=p.toString().padStart(2,"0"),Ct=f.toString().padStart(2,"0");return`${z}:${Ct}`}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=g({type:t,selectors:[["app-playlist-songs"]],inputs:{songs:"songs"},decls:18,vars:0,consts:[[1,"playlist-songs"],[1,"playlist-songs__album-header"],[1,"playlist-songs__date-header"],[1,"playlist-songs__duration-header"],["colspan","2",1,"separator"],[1,"playlist-song-details"],["alt","song.track.name",1,"playlist-song-img",3,"src"],[1,"playlist-song__names"],[1,"playlist-song-name"],[1,"playlist-song-artist"],[1,"playlist-songs__album-cell"],[1,"playlist-songs__date-cell"]],template:function(i,p){i&1&&(n(0,"table",0)(1,"thead")(2,"tr")(3,"th"),s(4,"#"),o(),n(5,"th"),s(6,"Title"),o(),n(7,"th",1),s(8,"Album"),o(),n(9,"th",2),s(10,"Release Date"),o(),n(11,"th")(12,"mat-icon",3),s(13,"access_time"),o()()()(),c(14,"tr",4),n(15,"tbody"),M(16,St,17,10,"tr",null,vt),o()()),i&2&&(l(16),O(p.songs))},dependencies:[L,it],styles:[".playlist-songs[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.separator[_ngcontent-%COMP%]{height:16px}.playlist-songs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.7rem 1rem;text-align:left}.playlist-songs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:#f8f9fa;padding:.7rem 1rem;text-align:left;font-weight:400;border-bottom:1px solid #dbdbdb}.playlist-songs__duration-header[_ngcontent-%COMP%]{width:20px;height:20px;font-size:20px}.playlist-songs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{padding-right:0}.playlist-song-img[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:4px;background:#8b8b8b}.playlist-song-details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.playlist-song__names[_ngcontent-%COMP%]{display:flex;flex-direction:column}.playlist-songs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, .playlist-songs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:right}.playlist-song-name[_ngcontent-%COMP%]{font-weight:500}td[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-bottom-left-radius:8px}td[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:8px;border-top-right-radius:8px}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#9caab81a}.playlist-songs__album-header[_ngcontent-%COMP%], .playlist-songs__album-cell[_ngcontent-%COMP%], .playlist-songs__date-header[_ngcontent-%COMP%], .playlist-songs__date-cell[_ngcontent-%COMP%]{display:none}@media (min-width: 48em){.playlist-songs__album-header[_ngcontent-%COMP%], .playlist-songs__album-cell[_ngcontent-%COMP%], .playlist-songs__date-header[_ngcontent-%COMP%], .playlist-songs__date-cell[_ngcontent-%COMP%]{display:table-cell}}.playlist-song-artist[_ngcontent-%COMP%]{color:#525252}"],changeDetection:0});let e=t;return e})();function Mt(e,t){e&1&&(n(0,"p"),s(1,"Processing..."),o())}function Ot(e,t){e&1&&(n(0,"div",1)(1,"mat-icon"),s(2,"check_circle"),o()(),n(3,"h1",2),s(4,"CONNECTED"),o(),n(5,"p",3),s(6," You logged into spotify account."),c(7,"br"),s(8," Now you can explore more features in spotify integration page "),o(),n(9,"a",4),s(10,"Return to integrations"),o())}function wt(e,t){e&1&&(n(0,"div",5)(1,"mat-icon"),s(2,"error_outline"),o()(),n(3,"h1",6),s(4,"FAILED TO CONNECT"),o(),n(5,"p",3),s(6," The integration to spotify is failed."),c(7,"br"),s(8," Try again later or contact our support service "),o(),n(9,"a",7),s(10,"Return hub"),o())}var mt=(()=>{let t=class t{constructor(a,i,p,f,z){this.spotifyService=a,this.route=i,this.cd=p,this.toastService=f,this.integrationsService=z,this.unsubscribe$=new Y,this.isLoading=!0,this.isSuccess=!1}ngOnInit(){this.handleAuth()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}handleAuth(){let a=this.route.snapshot.queryParamMap.get("code");a&&this.spotifyService.handleAuthCode(a).pipe(G(()=>{this.isLoading=!0,this.isSuccess=!1}),P(i=>(this.isSuccess=!1,this.toastService.error("Failed to log in spotify"),h(()=>i))),q(()=>{this.isLoading=!1,this.cd.markForCheck()})).subscribe(()=>{this.isSuccess=!0,this.toastService.open("Successfully integrated with spotify"),this.integrationsService.refreshIntegrations(),this.cd.markForCheck()})}};t.\u0275fac=function(i){return new(i||t)(y(w),y(j),y(tt),y(v),y(rt))},t.\u0275cmp=g({type:t,selectors:[["app-spotify-auth"]],decls:4,vars:3,consts:[[1,"spotify-auth__wrapper"],[1,"spotify-auth__icon"],[1,"spotify-auth__title"],[1,"spotify-auth__text"],["routerLink","/hub/integrations",1,"spotify-auth__button"],[1,"spotify-auth__icon","error"],[1,"spotify-auth__title","error"],["routerLink","/",1,"spotify-auth__button"]],template:function(i,p){i&1&&(n(0,"div",0),u(1,Mt,2,0,"p")(2,Ot,11,0)(3,wt,11,0),o()),i&2&&(l(),d(1,!p.isSuccess&&p.isLoading?1:-1),l(),d(2,p.isSuccess&&!p.isLoading?2:-1),l(),d(3,!p.isSuccess&&!p.isLoading?3:-1))},dependencies:[L,F],styles:[".spotify-auth__wrapper[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;flex-direction:column;justify-content:center;text-align:center}.spotify-auth__icon[_ngcontent-%COMP%]{display:flex;justify-content:center}.spotify-auth__icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:green}.spotify-auth__title[_ngcontent-%COMP%]{margin-top:40px!important;font-size:42px;font-weight:600;color:#068e44;color:green}.spotify-auth__text[_ngcontent-%COMP%]{margin-top:30px!important}.spotify-auth__button[_ngcontent-%COMP%]{margin-top:40px;padding:10px 24px;border:1px solid #a5a5a5;color:#242424;border-radius:4px}.error[_ngcontent-%COMP%]{color:#df2d2d}.error[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#df2d2d}"],changeDetection:0});let e=t;return e})();var kt=e=>["playlist",e];function Et(e,t){if(e&1&&(n(0,"div",0),c(1,"img",1),n(2,"h4",2),s(3),o(),n(4,"p",3),s(5),o()()),e&2){let r=_();m("routerLink",I(6,kt,r.playlist.id)),l(),m("src",r.playlist.images[0].url,b)("alt",r.playlist.name),l(2),k(" ",r.playlist.name," "),l(2),X(" Creator ",r.playlist.owner.displayName,", Tracks ",r.playlist.tracks.total," ")}}var yt=(()=>{let t=class t{constructor(){this.playlist=null}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=g({type:t,selectors:[["app-dashboard-playlist-item"]],inputs:{playlist:"playlist"},decls:1,vars:1,consts:[[1,"spotify-playlists__list-item",3,"routerLink"],["loading","lazy",1,"spotify-playlists__list-item-img",3,"src","alt"],[1,"spotify-playlists__list-item-title"],[1,"spotify-playlists__list-item-subtitle"]],template:function(i,p){i&1&&u(0,Et,6,8,"div",0),i&2&&d(0,p.playlist?0:-1)},dependencies:[F],styles:[".spotify-playlists__list-item[_ngcontent-%COMP%]{cursor:pointer;transition:all ease .4s}.spotify-playlists__list-item-img[_ngcontent-%COMP%]{width:100%;max-height:300px;margin-bottom:10px;border-radius:4px;background:#d3d3d3;object-fit:cover}@media screen and (max-width: 40em){.spotify-playlists__list-item-img[_ngcontent-%COMP%]{height:140px}}.spotify-playlists__list-item-title[_ngcontent-%COMP%]{margin-bottom:4px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.spotify-playlists__list-item-subtitle[_ngcontent-%COMP%]{font-size:12px;line-height:20px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"],changeDetection:0});let e=t;return e})();var K=(e,t)=>t.id;function It(e,t){if(e&1&&c(0,"app-dashboard-playlist-item",8),e&2){let r=t.$implicit;m("playlist",r)}}function At(e,t){if(e&1&&(n(0,"div",5)(1,"h2",6),s(2,"Your playlists"),o(),n(3,"div",7),M(4,It,1,1,"app-dashboard-playlist-item",8,K),o()()),e&2){let r=_(2);l(4),O(r.data.savedPlaylists)}}function jt(e,t){if(e&1&&c(0,"app-dashboard-playlist-item",8),e&2){let r=t.$implicit;m("playlist",r)}}function Ft(e,t){if(e&1&&(n(0,"div",5)(1,"h2",6),s(2,"Chill Mood"),o(),n(3,"div",7),M(4,jt,1,1,"app-dashboard-playlist-item",8,K),o()()),e&2){let r=_(2);l(4),O(r.data.chillPlaylists)}}function Lt(e,t){if(e&1&&c(0,"app-dashboard-playlist-item",8),e&2){let r=t.$implicit;m("playlist",r)}}function $t(e,t){if(e&1&&(n(0,"div",5)(1,"h2",6),s(2,"Trending"),o(),n(3,"div",7),M(4,Lt,1,1,"app-dashboard-playlist-item",8,K),o()()),e&2){let r=_(2);l(4),O(r.data.trendingPlaylists)}}function zt(e,t){if(e&1&&u(0,At,6,0,"div",5)(1,Ft,6,0,"div",5)(2,$t,6,0,"div",5),e&2){let r=_();d(0,r.data.savedPlaylists?0:-1),l(),d(1,r.data.chillPlaylists?1:-1),l(),d(2,r.data.trendingPlaylists?2:-1)}}function Nt(e,t){e&1&&(n(0,"div",3),s(1,"Loading"),o())}function Rt(e,t){e&1&&(n(0,"div",4),s(1,"Error"),o())}function Ut(e,t){if(e&1&&u(0,zt,3,3)(1,Nt,2,0,"div",3)(2,Rt,2,0,"div",4),e&2){let r=t;d(0,r.data?0:-1),l(),d(1,r?1:-1),l(),d(2,r.error?2:-1)}}var ft={newReleases:"0JQ5DAqbMKFz6FAsUtgAab",chill:"0JQ5DAqbMKFFzDl7qN9Apr",trending:"0JQ5DAqbMKFQIL0AXnG5AK"},_t=(()=>{let t=class t{constructor(a){this.spotifyService=a,this.playlists$=Q([this.spotifyService.getUsersSavedPlaylists(),this.spotifyService.getPlaylistsByCategory(ft.chill),this.spotifyService.getPlaylistsByCategory(ft.trending)]).pipe(H(([i,p,f])=>({savedPlaylists:i,chillPlaylists:p,trendingPlaylists:f})))}};t.\u0275fac=function(i){return new(i||t)(y(w))},t.\u0275cmp=g({type:t,selectors:[["app-spotify-dashboard"]],decls:6,vars:5,consts:[["value","Spotify"],[1,"page","spotify-home"],[1,"spotify-wrapper"],[1,"spotify-loading"],[1,"spotify-error"],[1,"spotify-playlists"],[1,"spotify-playlists__title"],[1,"spotify-playlists__list"],[3,"playlist"]],template:function(i,p){if(i&1&&(c(0,"app-page-header",0),n(1,"section",1)(2,"div",2),u(3,Ut,3,3),x(4,"withLoading"),x(5,"async"),o()()),i&2){let f;l(3),d(3,(f=E(5,3,E(4,1,p.playlists$)))?3:-1,f)}},dependencies:[$,yt,A,st],styles:[".spotify-home[_ngcontent-%COMP%]{display:flex;justify-content:center}.spotify-wrapper[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:column;gap:40px}@media screen and (max-width: 48em){.spotify-wrapper[_ngcontent-%COMP%]{width:100%}}.spotify-playlists__title[_ngcontent-%COMP%]{font-size:22px;font-weight:700;margin-bottom:20px}.spotify-playlists__list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));column-gap:24px;row-gap:30px;overflow-x:auto}@media screen and (max-width: 40em){.spotify-playlists__list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}}"],changeDetection:0});let e=t;return e})();var W=["#6366F1","#1D4ED8","#1A73E8","#EF4444","#FFC107","#F78DA7","#9B59B6"];var Bt=e=>({background:e});function Vt(e,t){if(e&1&&(n(0,"div",2)(1,"div",3),c(2,"img",4),n(3,"div",5)(4,"p",6),s(5,"Playlist"),o(),n(6,"h1",7),s(7),o()()()(),n(8,"div"),c(9,"app-playlist-songs",8),o()),e&2){let r=t,a=_();m("ngStyle",I(5,Bt,a.getRandomBackgroundColor())),l(2),m("src",r.images[0].url,b)("alt",r.name),l(5),C(r.name),l(2),m("songs",r.tracks.items)}}var gt=(()=>{let t=class t{constructor(a,i,p){this.route=a,this.spotifyService=i,this.toastService=p,this.playlist$=this.getPlaylist()}getRandomBackgroundColor(){let a=Math.floor(Math.random()*W.length);return`linear-gradient(to bottom, ${W[a]}, #f8f9fa)`}getPlaylist(){let a=this.route.snapshot.paramMap.get("playlistId");return a?this.spotifyService.getPlaylistDetailsById(a).pipe(P(i=>(this.toastService.open("Failed to get playlist"),h(()=>i),N))):(this.toastService.open("Playlist id is not found"),N)}};t.\u0275fac=function(i){return new(i||t)(y(j),y(w),y(v))},t.\u0275cmp=g({type:t,selectors:[["app-spotify-playlist"]],decls:4,vars:3,consts:[["value","Spotify Playlist"],[1,"page"],[1,"spotify-playlist",3,"ngStyle"],[1,"spotify-playlist-info"],[1,"spotify-playlist-img",3,"src","alt"],[1,"spotify-playlist-details"],[1,"spotify-playlist-title"],[1,"spotify-playlist-name"],[3,"songs"]],template:function(i,p){if(i&1&&(c(0,"app-page-header",0),n(1,"section",1),u(2,Vt,10,7),x(3,"async"),o()),i&2){let f;l(2),d(2,(f=E(3,1,p.playlist$))?2:-1,f)}},dependencies:[et,$,ct,A],styles:[".spotify-playlist[_ngcontent-%COMP%]{padding:2rem;min-height:20rem;border-radius:4px}@media screen and (max-width: 40em){.spotify-playlist[_ngcontent-%COMP%]{min-height:24rem;padding:1rem}}.spotify-playlist-info[_ngcontent-%COMP%]{display:flex;gap:30px}@media screen and (max-width: 40em){.spotify-playlist-info[_ngcontent-%COMP%]{flex-direction:column;align-items:center;justify-content:center;text-align:center;gap:20px}}.spotify-playlist-img[_ngcontent-%COMP%]{width:13rem;height:13rem;flex-shrink:0;border-radius:6px;box-shadow:0 25px 50px -12px #00000040;background:#afafaf}.spotify-playlist-details[_ngcontent-%COMP%]{margin-top:auto;padding-bottom:12px}.spotify-playlist-name[_ngcontent-%COMP%]{margin-top:6px;font-size:3rem;line-height:1;font-weight:700}@media screen and (max-width: 40em){.spotify-playlist-name[_ngcontent-%COMP%]{font-size:2rem}}.spotify-playlist-subtitle[_ngcontent-%COMP%]{margin-top:12px!important}"],changeDetection:0});let e=t;return e})();var Kt=(()=>{let t=class t{constructor(a,i){this.toastService=a,this.router=i}intercept(a,i){return a.url.includes("spotify")?i.handle(a).pipe(P(p=>p?.status===401?(this.router.navigate(["/hub/integrations"]),this.toastService.error("Spotify integration is not connected"),h(()=>p)):(this.toastService.error("Spotify integration is not available"),h(()=>p)))):i.handle(a)}};t.\u0275fac=function(i){return new(i||t)(R(v),R(at))},t.\u0275prov=J({token:t,factory:t.\u0275fac});let e=t;return e})(),ut=[{provide:ot,useClass:Kt,multi:!0}];var Wt=[{path:"",component:_t,title:"Spotify Dashboard | Kaiteki"},{path:"auth",component:mt,title:"Spotify Auth | Kaiteki"},{path:"playlist/:playlistId",component:gt,title:"Spotify Playlist | Kaiteki"}],ht=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=D({type:t}),t.\u0275inj=T({imports:[U.forChild(Wt),U]});let e=t;return e})();var ke=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=D({type:t}),t.\u0275inj=T({providers:[ut],imports:[nt,lt,ht]});let e=t;return e})();export{ke as a};
